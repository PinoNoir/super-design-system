import { Controls, Description, Meta, Story, Title, Canvas } from '@storybook/addon-docs/blocks';
import Table from '../Table';
import * as TableColumnsStories from './TableColumns.stories';

<Meta of={TableColumnsStories} />

<Title />

<Description />

The `createColumns` method is a utility function that generates a standardized column configuration array for the Table component. It provides a simplified approach to defining table columns without requiring row data props for each column definition.

## Signature

```typescript
const createColumns = (selectionHandler: TableSelectionCallback<TableRowData>) => ColumnDefinition[]
```

## Parameters

### selectionHandler

- **Type**: `TableSelectionCallback<TableRowData>`
- **Required**: Yes
- **Description**: A callback function that handles row selection events. This function is passed to both the checkbox and action button components to manage selection state.

## Return Value

Returns an array of `ColumnDefinition` objects, each containing the following properties:

- `key`: Unique identifier for the column
- `header`: Display text for the column header
- `width`: Column width in pixels
- `isSortable`: Boolean indicating if the column supports sorting
- `render`: Function that renders the cell content

## Usage Example

```typescript
const MyTableComponent = () => {
  const handleSelection = (rowId: string, isSelected: boolean) => {
    // Handle selection logic
    console.log(`Row ${rowId} ${isSelected ? 'selected' : 'deselected'}`);
  };

  // Define columns directly in component or extract to separate function
  const columns = createColumns(handleSelection);

  return (
    <Table
      columns={columns}
      data={tableData}
      // other props...
    />
  );
};
```

## Key Features

- **Simplified Configuration**: No need to pass row data props to individual columns
- **Built-in Selection**: Includes both checkbox and button selection mechanisms
- **Responsive, Custom Column Widths**: Predefined widths optimized for typical use cases
- **Type Safety**: Full TypeScript support with proper type definitions
- **Consistent Styling**: Standardized column definitions ensure UI consistency

## Technical Details

### Render Context

Both the selection checkbox and actions button receive a `RenderContext` object containing:

- `isSelected`: Boolean indicating the current selection state of the row

### Data Requirements

The method expects row data objects with the following properties:

- `id`: Unique row identifier
- Plus any additional properties needed by your specific columns (e.g., `name`, `email`, `status`, etc.)

### Example with Generic Data

```typescript
// Import types from @stretto/cds-ui
import { RenderContext, TableSelectionCallback } from '@stretto/cds-ui';

// Example with user data (any data set should be compatible)
const createUserColumns = (selectionHandler: TableSelectionCallback<UserData>) => [
  {
    key: 'select',
    header: '',
    isSortable: false,
    width: 38,
    render: (data: UserData, context: RenderContext) => (
      <TableCheckbox rowId={data.id} checked={context.isSelected} onSelectionChange={selectionHandler} />
    ),
  },
  {
    key: 'name',
    header: 'Name',
    width: 150,
    isSortable: true,
    render: (data: UserData) => data.name,
  },
  {
    key: 'email',
    header: 'Email',
    width: 200,
    isSortable: true,
    render: (data: UserData) => data.email,
  },
  {
    key: 'status',
    header: 'Status',
    width: 100,
    isSortable: true,
    render: (data: UserData) => data.status,
  },
  {
    key: 'actions',
    header: 'Actions',
    width: 100,
    isSortable: false,
    render: (data: UserData, context: RenderContext) => (
      <TableButton
        variant={context.isSelected ? 'primary' : 'secondary'}
        rowId={data.id}
        isSelected={context.isSelected}
        onSelectionChange={selectionHandler}
      >
        {context.isSelected ? 'Selected' : 'Select'}
      </TableButton>
    ),
  },
];
```

## Benefits

- **Reduced Boilerplate**: Eliminates repetitive column configuration code
- **Consistent Interface**: Ensures uniform table appearance across the application
- **Maintainability**: Centralized column definitions make updates easier
- **Type Safety**: Leverages TypeScript for compile-time error checking

## Working Example

<Canvas of={TableColumnsStories.CreateColumnsMethod} />
